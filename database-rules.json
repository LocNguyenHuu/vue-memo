{
  "rules": {
    ".read": true,
    "users": {
      "$uid": {
        ".write": "auth !== null && auth.uid === $uid",
        "name": {
          ".validate": "newData.isString() && 3 <= newData.val().length && newData.val().length <= 30"
        },
        "memos": {
          "$mid": {
            ".validate": "newData.isBoolean()"
          }
        },
        "stars": {
          "$mid": {
            ".write": "auth !== null && root.child('memos/' + $mid).child('publicWritePermissionData/stars').hasChild($uid) || auth.uid === $uid",
            "created": {
              ".validate": "newData.isNumber() && newData.val() < now + 5000 && newData.val() > 1480885998423"
            }
          }
        }
      },
      ".indexOn": ["name"]
    },
    "memos": {
      "$mid": {
        ".write": "auth !== null && auth.uid === newData.child('authorID').val() || data.child('authorID').val() === auth.uid",
        "memoName": {
          ".validate": "newData.isString() && newData.val().length >= 3 && newData.val().length <= 30"
        },
        "title": {
          ".validate": "newData.isString() && newData.val().length >= 5 && newData.val().length <= 120"
        },
        "body": {
          ".validate": "newData.isString() && newData.val().length >= 10 && newData.val().length <= 3000"
        },
        "authorID": {
          ".validate": "newData.isString()"
        },
        "created": {
          ".validate": "newData.isNumber() && newData.val() < now + 5000"
        },
        "modified": {
          ".validate": "newData.isNumber() && newData.val() < now + 5000 && newData.val() > 1480885998423"
        },
        "authorID_memoName": {
          ".validate": "newData.isString() && newData.val() === newData.parent().child('authorID').val() + '_' + newData.parent().child('memoName').val()"
        },
        "publicWritePermissionData": {
          ".write": "auth !== null && newData.child('stars').hasChild(auth.uid) || data.child('stars').hasChild(auth.uid)",
          "starCount": {
            ".validate": "newData.isNumber() && newData.val() >= 0"
          },
          "stars": {
            "$uid": {
              ".write": "auth !== null && auth.uid === $uid",
              ".validate": "newData.isBoolean()"
            }
          },
        }
      },
      ".indexOn": ["created", "memoName", "authorID", "authorID_memoName", "starCount"]
    }
  }
}